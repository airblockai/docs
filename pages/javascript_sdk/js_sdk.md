---
title: "Javascript SDK"
full: true
---

The Javascript SDK collects and sends browser events to an event collector of your choice. This SDK is open-source and available on [GitHub](https://github.com/airblockai/js-sdk).



# Quickstart
You'll need Node.js and a package manager like npm or yarn.

## Install SDK
Run `npm install --save @airblock/js-sdk` to install the SDK locally.
We have built-in typescript support so you do not need to install the types for the SDK.

## Initialize SDK
You must initialize the SDK before you collect any events.
To initialize, you must provide the `SERVER_URL` of your event collector and a string as `API_KEY` to identify your application. 

```js
import * as airblock from "@airblock/js-sdk";
 
const API_KEY = "app1"; // required
const SERVER_URL = "https://..."; // required
 
airblock.init(API_KEY, SERVER_URL);
```

Once initialized, the SDK will start sending default events to your event collector.



# Configuration Options

## Multiple applications
If you have multiple applications, you can use API_KEY to identify each application.
For example, you can use `API_KEY = "test"` for your test app and `API_KEY = "app1"` for production app.

## Opt users out of tracking
To disable tracking for a user, you can set `optOut` to `true`. If `optOut` is `true`, events aren't sent to the server. Default value `optOut` is `false`.

## Device fingerprinting
To disable device fingerprinting, you can set `fingerprinting` to `false`. If set to `false`, the SDK doesn't generate fingerprint. Default value is `true`.

```js
import * as airblock from "@airblock/js-sdk";
 
const API_KEY = "app1"; // required
const SERVER_URL = "https://..."; // required
 
airblock.init(API_KEY, SERVER_URL);
airblock.init(API_KEY, SERVER_URL, {
	optOut: false
	fingerprinting: true
    });
```



# Tracking Events
The SDK auto-tracks [default events](#default-events), including web3 wallet events. 
To track custom events, you can use the `track` function. You must call the `init` function before sending any events.

```js
import * as airblock from "@airblock/js-sdk";
 
const API_KEY = "app1"; // required
const SERVER_URL = "https://..."; // required
 
airblock.init(API_KEY, SERVER_URL);
airblock.track("swap_initiated"); 
```

## Event Structure

```
airblock.track(event name, [{event properties}, [{user properties}]])
```

```
// Track a basic event
airblock.track("swap_initiated")

// Track an event with both event and user properties
airblock.track("swap_initiated", {utm_source: "twitter"}, {sdk_ver: "0.1.1"})

// Track an event with event properties
airblock.track("swap_initiated", {utm_source: "twitter"})

// Track an event with only user properties
// Notice null event properties
airblock.track("swap_initiated", null, {sdk_ver: "0.1.1"})
```

The `track` function adds a few more parameters to the event before sending the event to the server. Here's how an event looks like on the server.

```
{
    "api_key": "app1",
    "ip_addr": "0.0.0.0", // user's IP address
    "uuid": "916be96d-4b92-4391-89d4-c1288bb2acc6", // user id generated by SDK
    "event_time": 1687431893993,
    "event_type": "swap_initiated", // event name
    "event_properties": { "utm_source": "twitter", "utm_medium": "airdrop" },
    "user_properties": { "sdk_ver": "0.1.1", "wallets": ["metamask"] }
}
```




## Flushing Event Buffer
By default, the SDK sends events to the server in batches. To send buffered events immediately, you can use the `flush` method. 

```js
import * as airblock from "@airblock/js-sdk";
 
const API_KEY = "app1"; // required
const SERVER_URL = "https://..."; // required
 
airblock.init(API_KEY, SERVER_URL);
airblock.track("swap_initiated"); 
airblock.track("swap_completed");
airblock.flush(); // this will send the event
```





# Default Events

## Session Start
The SDK sends `session_start` event at the start of each session.
The SDK auto-detects wallets installed in the user's browser.

```
{
    "uuid": "916be96d-4b92-4391-89d4-c1288bb2acc6",
    "event_time": 1687431893993,
    "event_type": "session_start",
    "user_properties": { "sdk_ver": "0.1.1", "wallets": ["metamask"] }
}
```


## Web Attribution
The SDK sends `attribution` event at the start of each session or whenever there's a change in attribution parameters within a session.

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "attribution",
    "event_properties": {
      "page_url": ,
      "referrer": ,
      "referring_domain": ,
      "utm_source": ,
      "utm_medium": ,
      "utm_campaign": ,
      "utm_content": ,
      "utm_term": ,
      "utm_id": 
    }
}
```

## Device Fingerprint
The SDK generates and sends device `fingerprint` event at the start of each session.

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "fingerprint",
    "user_properties": {
      "architecture": ,
      "audio": ,
      "canvas_hash": {},
      "colorDepth": ,
      "colorGamut": ,
      "contrast": ,
      "cookiesEnabled": ,
      "deviceMemory": ,
      "fontPreferences": {},
      "fonts": [],
      "forcedColors": ,
      "hardwareConcurrency": ,
      "hdr": ,
      "indexedDB": ,
      "languages": [],
      "localStorage": ,
      "math": {},
      "monochrome": 0,
      "openDatabase": ,
      "pdfViewerEnabled": ,
      "platform": ,
      "plugins": [],
      "reducedMotion": ,
      "screenFrame": [],
      "screenResolution": [],
      "sessionStorage": ,
      "timezone": "",
      "touchSupport": {},
      "vendor": "",
      "vendorFlavors": [],
      "videoCard": {},
      "visitorId": ""
    }
  }
```

## Metamask Wallet Events

### Metamask Wallets
If the SDK detects a connected Metamask wallet at the start of a session, it sends the `metamask_wallets` event.

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "metamask_wallets",
    "user_properties": {
      "accounts": ["0x4d42a0695724fe9a34fdg6d668a54f34dx968807"],
      "chainId": "0x89"
    }
}
```

### Metamask accountsChanged
The SDK sends `metamask_accountsChanged` event when a user changes her account in her Metamask wallet.

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "metamask_accountsChanged",
    "user_properties": {
      "newAddress": ["0x4d42a0695724fe9a34fdg6d668a54f34dx968807"],
      "chainId": "0x1"
    }
}
```

### Metamask chainChanged
The SDK sends `metamask_chainChanged` event when a user changes her blockchain in her Metamask wallet.

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "metamask_chainChanged",
    "user_properties": {
      "accounts": ["0x4d42a0695724fe9a34fdg6d668a54f34dx968807"],
      "chainId": "0x89"
    }
}
```

### Metamask Error

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "metamask_error",
    "event_properties": {
      "code": 4001,
      "message": "User rejected the request.",
      "stack": 
    }
}
```


## Coinbase Wallet Events

### Coinbase Wallets
If the SDK detects a connected Coinbase wallet at the start of a session, it sends the `coinbase_wallets` event.

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "coinbase_wallets",
    "user_properties": {
      "accounts": ["0x4d42a0695724fe9a34fdg6d668a54f34dx968807"],
      "chainId": "0x89"
    }
}
```

### Coinbase accountsChanged
The SDK sends `coinbase_accountsChanged` event when a user changes her account in her Coinbase wallet.

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "coinbase_accountsChanged",
    "user_properties": {
      "newAddress": ["0x4d42a0695724fe9a34fdg6d668a54f34dx968807"],
      "chainId": "0x1"
    }
}
```

### Coinbase chainChanged
The SDK sends `coinbase_chainChanged` event when a user changes her blockchain in her Coinbase wallet.

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "coinbase_chainChanged",
    "user_properties": {
      "accounts": ["0x4d42a0695724fe9a34fdg6d668a54f34dx968807"],
      "chainId": "0x89"
    }
}
```

### Coinbase Error

```
{
    "uuid": ,
    "event_time": ,
    "event_type": "coinbase_error",
    "event_properties": {
      "code": 4001,
      "message": "User denied account authorization",
      "stack": 
    }
}
```


# Tracking Wallet Errors
The SDK auto-detects most web3 wallet events but cannot auto-detect wallet error events. To track wallet errors, you can pass the error in a function.

## Metamask Errors
Call the `metamask_error` function.

```js
import * as airblock from "@airblock/js-sdk";
 
const API_KEY = "app1"; // required
const SERVER_URL = "https://..."; // required
 
airblock.init(API_KEY, SERVER_URL);

// Error handling
try {
  connectWallet();
} catch (err) {
  airblock.metamask_error(err);
}
```

## Coinbase Errors
Call the `coinbase_error` function.

```js
import * as airblock from "@airblock/js-sdk";
 
const API_KEY = "app1"; // required
const SERVER_URL = "https://..."; // required
 
airblock.init(API_KEY, SERVER_URL);

// Error handling
try {
  connectWallet();
} catch (err) {
  airblock.coinbase_error(err);
}
```